# Routopia: LLM-Driven White Agent for Real-Time Urban Ride-Hailing Dispatch

**Hengyu Fu, Baihe Huang, Wolin Jiang, Zihao Zhao**  
December 2025

---

## 1. Abstract

This project focuses on the creation of an autonomous _white agent_ capable of managing real-time ride-hailing dispatch where requests are submitted as unstructured natural language text. The primary metrics for success are defined as parsing accuracy, measured via Haversine distance and zone matching, and routing efficiency, quantified through revenue per mile and deadhead ratios.

The white agent design utilizes a multi-stage pipeline architecture that integrates GPT-4o for structured output, tool-augmented reasoning via the Google Maps API, and a personalization layer for user-specific context. Quantitative results indicate that the agent achieved a **100% parsing accuracy** on personalized requests, representing a significant improvement over the **85% accuracy** achieved by a pure natural-language baseline. This performance demonstrates the system’s robustness in translating complex human intent into precise operational actions.

---

## 2. Benchmark Section

While traditional benchmarks like the **Urban Routing Benchmark (URB)** focus on reinforcement learning for traffic network congestion, and others utilize the **Dial-a-Ride Problem (DARP)** for heuristic-based dispatch, our framework introduces the novelty of **online, natural-language demand understanding**.

The benchmark functions by having a _green agent_ stream realistic requests derived from **NYC TLC High-Volume For-Hire Vehicle records**, covering over **263 taxi zones**. This environment evaluates the white agent’s ability to interpret diverse request dimensions, ranging from:

- Basic point-to-point trips
- Complex POI-based queries
- Time-constrained _urgent_ requests
- Special requirements

Technically, the green agent operates as the central orchestrator, maintaining a dynamic fleet of vehicles and simulating a **twelve-hour operational window**. At each step, the white agent receives:

- A raw text string
- A customer ID
- A timestamp

The white agent must return a structured dispatch plan. The green agent then evaluates performance through **point-in-polygon verification** and **temporal feasibility checks**. Assignments are strictly rejected if a vehicle is unavailable or if the proposed plan cannot meet pickup or arrival windows, ensuring the benchmark reflects the high-stakes nature of urban mobility.

---

## 3. White Agent Framework

The white agent is built upon a **multi-stage pipeline architecture** emphasizing tool-augmented reasoning and personalization.

### 3.1 Parsing and Context Injection

The process begins with a **Parser Module** that employs GPT-4o to transform raw text into a structured schema using **Pydantic**. If the request involves relative locations (e.g., _“from my home”_), the system triggers a **context injection** step to retrieve relevant coordinates from a user database.

### 3.2 Geocoding and Spatial Validation

This is followed by a **geocoding phase**, where the agent uses the **Google Maps API** to resolve points of interest into precise latitude and longitude coordinates. To ensure spatial integrity, geometric algorithms are applied to verify alignment with valid NYC taxi zones.

### 3.3 Routing and Dispatch

The final stage is the **routing module**, which uses a greedy heuristic to select the optimal vehicle from a dynamic database. This module balances:

- Vehicle proximity
- Parsing-derived constraints (e.g., wheelchair accessibility)
- Temporal constraints (e.g., arrival deadlines)

By maintaining a clear separation between **semantic parsing** and **spatial routing**, the architecture enables high-precision decision-making. This tool-augmented approach ensures that the agent validates real-world locations and fleet constraints before issuing a final dispatch command.

---

## 4. Experiment Section

Experimental results demonstrate the advantage of incorporating personalization and tool-augmented reasoning into the dispatch process.

### 4.1 Quantitative Results

Compared to a baseline relying solely on natural language parsing without user-specific context, the white agent improved parsing accuracy from **85% to 100%**.

The generalizability of this performance was validated by tuning:

- Template ratios
- Temperature parameters of synthetic requests generated by the green agent

Despite increased linguistic variability, the agent maintained consistent performance in understanding user intent, indicating strong robustness to noisy and unpredictable real-world phrasing.

### 4.2 Qualitative Analysis

Qualitative trajectory analysis highlights the agent’s reasoning depth:

- **Successful case:**  
  The agent resolved the ambiguous phrase _“my office”_ by querying the customer profile, enabling an efficient dispatch with minimal deadhead mileage.

- **Multi-constraint urgent request:**  
  The agent correctly prioritized a vehicle capable of meeting a strict **30-minute arrival deadline**.

- **Failure case:**  
  A cascading error occurred when the geocoding tool returned coordinates for the wrong airport. Lacking a cross-validation step between POI names and resolved zones, the agent proceeded with an incorrect assignment.

This failure suggests that future iterations should include **semantic sanity checks** to detect tool-based hallucinations or disambiguation errors.

---
